@prefix xarm: <http://ns.inria.fr/hmas/artifacts/cherrybot.ttl#> .

@prefix hmas: <https://purl.org/hmas/> .

@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix hctl: <https://www.w3.org/2019/wot/hypermedia#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .

###########
# Classes #
###########

xarm:XArmRoboticArm a owl:Class ;
    rdfs:label "XArm Robotic Arm"@en .

xarm:AuthorizedOperator a owl:Class ;
    rdfs:label "Authorized Operator"@en .

xarm:Operator a owl:Class ;
    rdfs:label "Operator"@en .

xarm:Coordinates a owl:Class ;
    rdfs:label "Coordinates"@en .

xarm:Rotation a owl:Class ;
    rdfs:label "Rotation"@en .

xarm:TcpTarget a owl:Class ;
    rdfs:label "TCP Target"@en .

xarm:TcpMovement a owl:Class ;
	rdfs:label "TcpMovement"@en .

###################
# Data Properties #
###################

xarm:hasOperatorToken a owl:DatatypeProperty ;
	rdfs:domain xarm:AuthorizedOperator ;
	rdfs:label "Has Operator Token"@en .

xarm:hasXCoordinate a owl:DatatypeProperty ;
	rdfs:domain xarm:Coordinates ;
	rdfs:label "Has X Coordinate"@en .

xarm:hasYCoordinate a owl:DatatypeProperty ;
	rdfs:domain xarm:Coordinates ;
	rdfs:label "Has Y Coordinate"@en .

xarm:hasZCoordinate a owl:DatatypeProperty ;
	rdfs:domain xarm:Coordinates ;
	rdfs:label "Has Z Coordinate"@en .

xarm:hasRoll a owl:DatatypeProperty ;
	rdfs:domain xarm:Rotation ;
	rdfs:label "Has Roll"@en .

xarm:hasPitch a owl:DatatypeProperty ;
	rdfs:domain xarm:Rotation ;
	rdfs:label "Has Pitch"@en .

xarm:hasYaw a owl:DatatypeProperty ;
	rdfs:domain xarm:Rotation ;
	rdfs:label "Has Yaw"@en .

#####################
# Object Properties #
#####################

xarm:hasCoordinates a owl:ObjectProperty ;
	rdfs:domain xarm:TcpTarget ;
	rdfs:range xarm:Coordinates ;
	rdfs:label "Has Coordinates"@en .

xarm:hasRotation a owl:ObjectProperty ;
	rdfs:domain xarm:TcpTarget ;
	rdfs:range xarm:Rotation ;
	rdfs:label "Has Rotation"@en .

######################
# Catalog Definition #
######################

xarm:CherrybotCatalog a hmas:SignifiersCatalog ;
    hmas:proposesSignifier xarm:ReadableOperator ,
                           xarm:ReadablePosition ,
                           xarm:ReadableTarget ,
                           xarm:ReadableGripper ,
                           xarm:InitializableArm ,
                           xarm:SettableOperator ,
                           xarm:SettableTarget ,
                           xarm:SettableGripper ,
                           xarm:DeletableOperator .

#######################################
# Robotic Arm Endpoint specifications #
#######################################

xarm:ReadableOperator a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue  "/operator"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape xarm:JsonGetOperatorOutputBody
        ]
    ] .

xarm:ReadablePosition a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue  "/tcp"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape xarm:JsonGetPositionOutputBody
        ]
    ] .

xarm:ReadableTarget a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/tcp/target"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape xarm:JsonGetPositionOutputBody
        ]
    ] .

xarm:ReadableGripper a sh:NodeShape , rdfs:Class ;
    hmas:signifies [
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/gripper"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:minExclusive 0 ;
            sh:maxExclusive 800 ;
            sh:datatype xsd:integer
        ]
    ] .

xarm:InitializableArm a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:InvokeAction, hmas:PutMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/initialize"
                ]
            ]
        ]
    ] .

xarm:SettableOperator a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/operator"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape xarm:JsonSetOperatorInputBody
        ]
    ] .

xarm:SettableTarget a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/tcp/target"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape xarm:JsonSetPositionInputBody
        ]
    ] .

xarm:SettableGripper a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/gripper"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:datatype xsd:integer ;
            sh:minExclusive 0 ;
            sh:maxExclusive 800
        ]
    ] .

xarm:DeletableOperator a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:InvokeAction, hmas:DeleteMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/operator/%7Btoken%7D"
                ]
            ]
        ]
    ] .

################################
# Intput/Output specifications #
################################

xarm:JsonGetOperatorOutputBody a sh:NodeShape ;
    sh:class xarm:AuthorizedOperator ;
    sh:property [
        sh:path foaf:Name;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path foaf:mbox ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path xarm:hasOperatorToken ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] .

xarm:JsonSetOperatorInputBody a sh:NodeShape ;
    sh:class xarm:Operator ;
    sh:property [
        sh:path foaf:name ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path foaf:mbox ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] .

xarm:JsonRotationElement a sh:NodeShape ;
    sh:class xarm:Coordinates ;
    sh:property [
        sh:path xarm:hasXCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path xarm:hasYCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path xarm:hasZCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] .

xarm:JsonTranslationElement a sh:NodeShape ;
    sh:class xarm:Rotation ;
    sh:property [
        sh:path xarm:hasRoll ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path xarm:hasPitch ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path xarm:hasYaw ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] .

xarm:JsonGetPositionOutputBody a sh:NodeShape ;
    sh:class xarm:TcpTarget ;
    sh:property [
        sh:path xarm:hasCoordinates ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape xarm:JsonTranslationElement
    ] , [
        sh:path xarm:hasRotation ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape xarm:JsonRotationElement
    ] .

xarm:JsonSetPositionInputBody a sh:NodeShape ;
    sh:class xarm:TcpMovement ;
    sh:property [
        sh:path xarm:hasCoordinates ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape xarm:JsonTranslationElement
    ] , [
        sh:path xarm:hasRotation ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape xarm:JsonRotationElement
    ] .
