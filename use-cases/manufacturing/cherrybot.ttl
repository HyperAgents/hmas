@prefix m5stack: <docs.m5stack.com/en/products/> .
@prefix cherrybot: <https://interactions.ics.unisg.ch/cherrybot#> .

@prefix hmas: <https://purl.org/hmas/> .

@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix hctl: <https://www.w3.org/2019/wot/hypermedia#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .

######################
# Catalog Definition #
######################

m5stack:CherrybotCatalog a hmas:SignifiersCatalog ;
    hmas:proposesSignifier [ hmas:signifies m5stack:CherrybotReadableOperator ] ,
                           [ hmas:signifies m5stack:CherrybotReadablePosition ] ,
                           [ hmas:signifies m5stack:CherrybotReadableTarget ] ,
                           [ hmas:signifies m5stack:CherrybotReadableGripper ] ,
                           [ hmas:signifies m5stack:CherrybotInitializableArm ] ,
                           [ hmas:signifies m5stack:CherrybotSettableOperator ] ,
                           [ hmas:signifies m5stack:CherrybotSettableTarget ] ,
                           [ hmas:signifies m5stack:CherrybotSettableGripper ] ,
                           [ hmas:signifies m5stack:CherrybotDeletableOperator ] .

#######################################
# Robotic Arm Endpoint specifications #
#######################################

m5stack:CherrybotReadableOperator a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue  "/operator"
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape m5stack:JsonGetOperatorOutputBody
    ] .

m5stack:CherrybotReadablePosition a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue  "/tcp"
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape m5stack:JsonGetPositionOutputBody
    ] .

m5stack:CherrybotReadableTarget a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/tcp/target"
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape m5stack:JsonGetPositionOutputBody
    ].

m5stack:CherrybotReadableGripper a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/gripper"
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:minExclusive 0 ;
        sh:maxExclusive 800 ;
        sh:datatype xsd:integer
    ] .

m5stack:CherrybotInitializableArm a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:InvokeAction, hmas:PutMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/initialize"
            ]
        ]
    ] .

m5stack:CherrybotSettableOperator a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/operator"
            ]
        ]
    ] , [
        sh:path hmas:hasInput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape m5stack:JsonSetOperatorInputBody
    ] .

m5stack:CherrybotSettableTarget a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/tcp/target"
            ]
        ]
    ] , [
        sh:path hmas:hasInput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape m5stack:JsonSetPositionInputBody
    ] .

m5stack:CherrybotSettableGripper a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/gripper"
            ]
        ]
    ] , [
        sh:path hmas:hasInput ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:integer ;
        sh:minExclusive 0 ;
        sh:maxExclusive 800
    ] .

m5stack:CherrybotDeletableOperator a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas:InvokeAction, hmas:DeleteMethod, hmas:forApplicatonJson, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/operator/%7Btoken%7D"
            ]
        ]
    ] .

################################
# Intput/Output specifications #
################################

m5stack:JsonGetOperatorOutputBody a sh:NodeShape ;
    sh:class cherrybot:OperatorWithTokenSchema ;
    sh:property [
        sh:path foaf:Name;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path foaf:mbox ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path cherrybot:operatorToken ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] .

m5stack:JsonSetOperatorInputBody a sh:NodeShape ;
    sh:class cherrybot:OperatorSchema ;
    sh:property [
        sh:path foaf:name ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path foaf:mbox ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] .

m5stack:JsonRotationElement a sh:NodeShape ;
    sh:class cherrybot:CoordinatesSchema ;
    sh:property [
        sh:path cherrybot:xCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:yCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:zCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] .

m5stack:JsonTranslationElement a sh:NodeShape ;
    sh:class cherrybot:RotationSchema ;
    sh:property [
        sh:path cherrybot:roll ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:pitch ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:yaw ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] .

m5stack:JsonGetPositionOutputBody a sh:NodeShape ;
    sh:class cherrybot:TcpTargetSchema ;
    sh:property [
        sh:path cherrybot:coordinate ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape m5stack:JsonTranslationElement
    ] , [
        sh:path cherrybot:rotation ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape m5stack:JsonRotationElement
    ] .

m5stack:JsonSetPositionInputBody a sh:NodeShape ;
    sh:class cherrybot:TcpMovementSchema ;
    sh:property [
        sh:path cherrybot:coordinate ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape m5stack:JsonTranslationElement
    ] , [
        sh:path cherrybot:rotation ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape m5stack:JsonRotationElement
    ] .
