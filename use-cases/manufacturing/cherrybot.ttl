@prefix ufactory: <https://eu.robotshop.com/fr/collections/ufactory/> .
@prefix cherrybot: <https://interactions.ics.unisg.ch/cherrybot#> .

@prefix hmas: <https://purl.org/hmas/> .
@prefix hmas-dev: <https://purl.org/hmas/dev#> .

@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix hctl: <https://www.w3.org/2019/wot/hypermedia#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema> .
@prefix foaf: <http://xmlns.com/foaf/0.1/> .

######################
# Catalog Definition #
######################

ufactory:CherrybotCatalog a hmas:SignifiersCatalog ;
    hmas:proposesSignifier ufactory:CherrybotReadableOperator ,
                           ufactory:CherrybotReadablePosition ,
                           ufactory:CherrybotReadableTarget ,
                           ufactory:CherrybotReadableGripper ,
                           ufactory:CherrybotInitializableArm ,
                           ufactory:CherrybotSettableOperator ,
                           ufactory:CherrybotSettableTarget ,
                           ufactory:CherrybotSettableGripper ,
                           ufactory:CherrybotDeletableOperator .

#######################################
# Robotic Arm Endpoint specifications #
#######################################

ufactory:CherrybotReadableOperator a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:ReadProperty, hmas-dev:GetMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue  "/operator"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape ufactory:JsonGetOperatorOutputBody
        ]
    ] .

ufactory:CherrybotReadablePosition a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:ReadProperty, hmas-dev:GetMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue  "/tcp"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape ufactory:JsonGetPositionOutputBody
        ]
    ] .

ufactory:CherrybotReadableTarget a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:ReadProperty, hmas-dev:GetMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/tcp/target"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape ufactory:JsonGetPositionOutputBody
        ]
    ] .

ufactory:CherrybotReadableGripper a sh:NodeShape , rdfs:Class ;
    hmas:signifies [
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:ReadProperty, hmas-dev:GetMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/gripper"
                ]
            ]
        ] , [
            sh:path hmas:hasOutput ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:minExclusive 0 ;
            sh:maxExclusive 800 ;
            sh:datatype xsd:integer
        ]
    ] .

ufactory:CherrybotInitializableArm a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:InvokeAction, hmas-dev:PutMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/initialize"
                ]
            ]
        ]
    ] .

ufactory:CherrybotSettableOperator a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/operator"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape ufactory:JsonSetOperatorInputBody
        ]
    ] .

ufactory:CherrybotSettableTarget a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/tcp/target"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape ufactory:JsonSetPositionInputBody
        ]
    ] .

ufactory:CherrybotSettableGripper a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/gripper"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:datatype xsd:integer ;
            sh:minExclusive 0 ;
            sh:maxExclusive 800
        ]
    ] .

ufactory:CherrybotDeletableOperator a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas-dev:InvokeAction, hmas-dev:DeleteMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/operator/%7Btoken%7D"
                ]
            ]
        ]
    ] .

################################
# Intput/Output specifications #
################################

ufactory:JsonGetOperatorOutputBody a sh:NodeShape ;
    sh:class cherrybot:OperatorWithTokenSchema ;
    sh:property [
        sh:path foaf:Name;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path foaf:mbox ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path cherrybot:operatorToken ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] .

ufactory:JsonSetOperatorInputBody a sh:NodeShape ;
    sh:class cherrybot:OperatorSchema ;
    sh:property [
        sh:path foaf:name ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] , [
        sh:path foaf:mbox ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ] .

ufactory:JsonRotationElement a sh:NodeShape ;
    sh:class cherrybot:CoordinatesSchema ;
    sh:property [
        sh:path cherrybot:xCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:yCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:zCoordinate ;
        sh:minExclusive -7.2E2 ;
        sh:maxExclusive 7.2E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] .

ufactory:JsonTranslationElement a sh:NodeShape ;
    sh:class cherrybot:RotationSchema ;
    sh:property [
        sh:path cherrybot:roll ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:pitch ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] , [
        sh:path cherrybot:yaw ;
        sh:minExclusive -1.8E2 ;
        sh:maxExclusive 1.8E2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:float 
    ] .

ufactory:JsonGetPositionOutputBody a sh:NodeShape ;
    sh:class cherrybot:TcpTargetSchema ;
    sh:property [
        sh:path cherrybot:coordinate ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape ufactory:JsonTranslationElement
    ] , [
        sh:path cherrybot:rotation ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape ufactory:JsonRotationElement
    ] .

ufactory:JsonSetPositionInputBody a sh:NodeShape ;
    sh:class cherrybot:TcpMovementSchema ;
    sh:property [
        sh:path cherrybot:coordinate ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape ufactory:JsonTranslationElement
    ] , [
        sh:path cherrybot:rotation ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape ufactory:JsonRotationElement
    ] .
