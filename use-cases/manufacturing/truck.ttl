@prefix artifacts-truck: <http://ns.inria.fr/hmas/artifacts/truck.ttl#> .

@prefix hmas: <https://purl.org/hmas/> .

@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix hctl: <https://www.w3.org/2019/wot/hypermedia#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema> .


artifacts-truck:TruckCatalog a hmas:SignifiersCatalog ;
    hmas:proposesSignifier artifacts-truck:TruckReadableBattery ,
                           artifacts-truck:TruckReadableAccelerometer ,
                           artifacts-truck:TruckSettableWheels .

###################
# Truck Endpoints #
###################

artifacts-truck:TruckReadableBattery a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/properties/batteryvoltage"
                ]
            ]
        ], [
           sh:path hmas:hasOutput ;
           sh:datatype xsd:float ;
           sh:minCount 1 ;
           sh:maxCount 1 
        ]
    ] .

artifacts-truck:TruckReadableAccelerometer a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:ReadProperty, hmas:GetMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/properties/motorcurrent"
                ]
            ]
        ], [
           sh:path hmas:hasOutput ;
           sh:datatype xsd:float ;
           sh:minCount 1 ;
           sh:maxCount 1 
        ]
    ] .

artifacts-truck:TruckSettableWheels a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape , rdfs:Class ;
        sh:class hmas:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property hmas:InvokeAction, hmas:PostMethod, hmas:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/actions/wheelControl"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:qualifiedMinCount 1 ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape artifacts-truck:JsonControlWheelBody
        ]
    ] .


#######################
# Json Specifications #
#######################

artifacts-truck:JsonControlWheelBody a sh:NodeShape ;
    sh:class artifacts-truck:Vehicle ;
    sh:property [
        sh:path artifacts-truck:hasDirectionValue ;
        sh:minExclusive 0 ;
        sh:maxExclusive 2 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:integer 
    ] , [
        sh:path artifacts-truck:hasSpeedValue ;
        sh:minExclusive -7 ;
        sh:maxExclusive 7 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:integer 
    ] , [
        sh:path artifacts-truck:hasDurationValue ;
        sh:minExclusive 0 ;
        sh:maxExclusive 5000 ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:integer 
    ] .
