@base <https://ns.inria.fr/hmas/> .

@prefix org-dataset: <http://ns.inria.fr/hmas/organizations/organization-dataset.ttl#> .
@prefix org-yogurt: <http://ns.inria.fr/hmas/organizations/yogurt-organization-specification.ttl#> .

@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix hmas: <https://purl.org/hmas/> .

@prefix agent-a: <workspaces/cup-production-site/agents/agent-a#> .
@prefix agent-e: <workspaces/cup-production-site/agents/agent-e#> .
@prefix agent-ra: <Market-Place/agents/agent-ra#> .

@prefix ypr-org: <organizations/ypr#> .

######################################
# Generic organization specification #
######################################

# Memberships specifications

org-yogurt:ProductionOperator a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-yogurt:Operator
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class org-yogurt:ProductionGroup ]
    ] .

org-yogurt:ProductionFactoryManager a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-yogurt:FactoryManager
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class org-yogurt:ProductionGroup ]
    ] .

org-yogurt:BusinessFactoryManagerRepresentative a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-yogurt:FactoryManagerRepresentative
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class org-yogurt:BusinessGroup ]
    ] .

# Generic organization specification

org-yogurt:GenericYogurtCompanyOrganization a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Organization ;
    sh:property [
        sh:path hmas:hasOrganizationalValue ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-dataset:IntegrityRespect
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-yogurt:FactoryManagerRepresentative
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-yogurt:FactoryManager
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue org-yogurt:Operator
    ] , [
        sh:path hmas:isStructuredBy ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class org-yogurt:BusinessGroup ] ;
        sh:qualifiedValuesShapeDisjoint true
    ] , [
        sh:path hmas:isStructuredBy ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class org-yogurt:ProductionGroup ] ; 
        sh:qualifiedValuesShapeDisjoint true
    ] .

###########################################
# Instanciation of the organization shape #
###########################################

org-yogurt:YPRBusinessGroup a org-yogurt:BusinessGroup .
org-yogurt:YPRProductionGroup a org-yogurt:ProductionGroup .

org-yogurt:YPRProductionOperator a org-yogurt:ProductionOperator ;
    hmas:isMembershipOf agent-e:agent ;
    hmas:isMembershipFor org-yogurt:Operator ;
    hmas:isMembershipIn org-yogurt:ProductionGroup .

org-yogurt:YPRProductionFactoryManager a org-yogurt:ProductionFactoryManager ;
    hmas:isMembershipOf agent-a:agent ;
    hmas:isMembershipFor org-yogurt:FactoryManager ;
    hmas:isMembershipIn org-yogurt:ProductionGroup .

org-yogurt:YPRBusinessFactoryManagerRepresentative a org-yogurt:BusinessFactoryManagerRepresentative ;
    hmas:isMembershipOf agent-ra:agent ;
    hmas:isMembershipFor org-yogurt:FactoryManagerRepresentative ;
    hmas:isMembershipIn org-yogurt:BusinessGroup .

org-yogurt:YPRProductionOperator org-yogurt:canCommunicateWith org-yogurt:YPRBusinessFactoryManagerRepresentative .
org-yogurt:YPRProductionOperator org-yogurt:canCommunicateWith org-yogurt:YPRProductionOperator .
