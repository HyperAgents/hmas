@base <https://ns.inria.fr/hmas/> .

@prefix ex: <https://www.example.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix hmas: <https://purl.org/hmas/> .

@prefix ag-b: <workspaces/cup-production-site/agents/agent-b#> .
@prefix ag-c: <workspaces/cup-production-site/agents/agent-c#> .
@prefix agent-rb: <Market-Place/agents/agent-rb#> .

@prefix cpr-org: <organizations/cpr#> .

######################################
# Generic organization specification #
######################################

# Memberships specifications

ex:ProductionOperator a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:hasValue ex:Operator
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:ProductionGroup ]
    ] .

ex:ProductionOrderManager a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:hasValue ex:OrderManager
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:ProductionGroup ]
    ] .

ex:BusinessSellerRepresentative a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership , rdfs:Class ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:hasValue ex:SellerRepresentative
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:BusinessGroup ]
    ] .

# Generic organization specification

ex:GenericCupCompanyOrganization a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Organization ;
    sh:property [
        sh:path hmas:hasOrganizationalValue ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:IntegrityRespect
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:SellerRepresentative 
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:OrderManager
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:Operator
    ] , [
        sh:path hmas:isStructuredBy ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:BusinessGroup ] ;
        sh:qualifiedValuesShapeDisjoint true
    ] , [
        sh:path hmas:isStructuredBy ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:ProductionGroup ] ; 
        sh:qualifiedValuesShapeDisjoint true
    ] .

###########################################
# Instanciation of the organization shape #
###########################################

ex:CPRBusinessGroup a ex:BusinessGroup .
ex:CPRProductionGroup a ex:ProductionGroup .

ex:CPRProductionOperator a ex:ProductionOperator ;
    hmas:isMembershipOf ag-c:agent ;
    hmas:isMembershipFor ex:Operator ;
    hmas:isMembershipIn ex:ProductionGroup .

ex:CPRProductionOrderManager a ex:ProductionOrderManager ;
    hmas:isMembershipOf ag-b:agent ;
    hmas:isMembershipFor ex:OrderManager ;
    hmas:isMembershipIn ex:ProductionGroup .

ex:CPRBusinessSellerRepresentative a ex:BusinessSellerRepresentative ;
    hmas:isMembershipOf agent-rb:agent ;
    hmas:isMembershipFor ex:SellerRepresentative ;
    hmas:isMembershipIn ex:BusinessGroup .

ex:CPRProductionOrderManager ex:canCommunicateWith ex:CPRBusinessSellerRepresentative .
ex:CPRProductionOrderManager ex:canCommunicateWith ex:CPRProductionOperator .


