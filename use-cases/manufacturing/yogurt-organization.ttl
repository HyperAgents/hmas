@base <https://ns.inria.fr/hmas/> .

@prefix ex: <https://www.example.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix hmas: <https://purl.org/hmas/> .

@prefix agent-a: <workspaces/cup-production-site/agents/agent-a#> .
@prefix agent-e: <workspaces/cup-production-site/agents/agent-e#> .
@prefix agent-ra: <Market-Place/agents/agent-ra#> .

@prefix ypr-org: <organizations/ypr#> .

######################################
# Generic organization specification #
######################################

# Organizational value specification

ex:IntegrityRespect a hmas:OrganizationalValue ;
    rdfs:comment "Communicate openly and honestly with the customers and other members of the organization."@en ;
    rdfs:label "integrity and respect"@en, "intégrité et respect"@fr .

# Roles specifications

ex:FactoryManagerRepresentative a hmas:Role .
ex:FactoryManager a hmas:Role .
ex:Operator a hmas:Role .

# Groups specifications

ex:BusinessGroup a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Group .

ex:ProductionGroup a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Group .

# Memberships specifications

ex:ProductionOperator a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:Operator ]
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:ProductionGroup ]
    ] .

ex:ProductionFactoryManager a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:FactoryManager ]
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:ProductionGroup ]
    ] .

ex:BusinessFactoryManagerRepresentative a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Membership ;
    sh:property [
        sh:path hmas:isMembershipOf ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class hmas:Agent ]
    ] , [
        sh:path hmas:isMembershipFor ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:FactoryManagerRepresentative ]
    ] , [
        sh:path hmas:isMembershipIn ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:BusinessGroup ]
    ] .

## Relation Specifications
ex:canCommunicateWith rdfs:subPropertyOf hmas:hasMembershipRelationshipWith .

# Generic organization specification

ex:GenericYogurtCompanyOrganization a sh:NodeShape , rdfs:Class ;
    rdfs:subClassOf hmas:Organization ;
    sh:property [
        sh:path hmas:hasOrganizationalValue ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:IntegrityRespect
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:FactoryManagerRepresentative
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:FactoryManager
    ] , [
        sh:path hmas:providesRole ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:hasValue ex:Operator
    ] , [
        sh:path hmas:isStructuredBy ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:BusinessGroup ] ;
        sh:qualifiedValuesShapeDisjoint true
    ] , [
        sh:path hmas:isStructuredBy ;
        sh:qualifiedMinCount 1 ;
        sh:qualifiedMaxCount 1 ;
        sh:qualifiedValueShape [ sh:class ex:ProductionGroup ] ; 
        sh:qualifiedValuesShapeDisjoint true
    ] .

###########################################
# Instanciation of the organization shape #
###########################################

ex:YPRBusinessGroup a ex:BusinessGroup .
ex:YPRProductionGroup a ex:ProductionGroup .

ex:YPRProductionOperator a ex:ProductionOperator ;
    hmas:isMembershipOf agent-e:agent ;
    hmas:isMembershipFor ex:Operator ;
    hmas:isMembershipIn ex:ProductionGroup .

ex:YPRProductionFactoryManager a ex:ProductionFactoryManager ;
    hmas:isMembershipOf agent-a:agent ;
    hmas:isMembershipFor ex:FactoryManager ;
    hmas:isMembershipIn ex:ProductionGroup .

ex:YPRBusinessFactoryManagerRepresentative a ex:BusinessFactoryManagerRepresentative ;
    hmas:isMembershipOf agent-ra:agent ;
    hmas:isMembershipFor ex:FactoryManagerRepresentative ;
    hmas:isMembershipIn ex:BusinessGroup .

ex:YPRProductionOperator ex:canCommunicateWith ex:YPRBusinessFactoryManagerRepresentative .
ex:YPRProductionOperator ex:canCommunicateWith ex:YPRProductionOperator .

# Finally define the YPR organization

ypr-org:organization a ex:GenericYogurtCompanyOrganization ;
    hmas:hasProfile ypr-org: ;
    hmas:hasOrganizationalValue ex:IntegrityRespect ;
    hmas:providesRole ex:FactoryManagerRepresentative , ex:FactoryManager , ex:Operator ;
    hmas:isStructuredBy ex:YPRBusinessGroup , ex:YPRProductionGroup .
