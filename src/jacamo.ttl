@prefix hmas: <https://purl.org/hmas/> .
@prefix jacamo: <https://purl.org/hmas/jacamo#> .
@prefix aa: <https://purl.org/hmas/agents-artifacts#> .
@prefix jason-kqml: <https://purl.org/hmas/json-kqml#> .
@prefix hmas-dev: <https://purl.org/hmas/dev#> .

@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix wotsec: <https://www.w3.org/2019/wot/security#> .
@prefix http: <http://www.w3.org/2011/http#> .
@prefix hctl: <https://www.w3.org/2019/wot/hypermedia#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix jsonld: <http://www.w3.org/ns/json-ld#> .

########################
# Workspace Signifiers #
########################

jacamo:WorkspaceCatalog a hmas:SignifiersCatalog ;
    hmas:proposesSignifier jacamo:PerceivableWorkspace ,
                           jacamo:PartitionableWorkspace ,
                           jacamo:UpdatableWorkspace ,
                           jacamo:DeletableWorkspace ,
                           jacamo:JoinableWorkspace ,
                           jacamo:LeavableWorkspace ,
                           jacamo:FocusableWorkspace,
                           jacamo:ArtifactCreatableWorkspace,
                           jacamo:ArtifactContainableWorkspace.

jacamo:PerceivableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:ReadAction, hmas-dev:GetMethod, hmas-dev:forTextTurtle, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:WorkspaceProfileSpecification
    ] 
].

jacamo:PartionableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forTextTurtle, hmas-dev:SlugHeader, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path hmas:hasInput ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:WorkspaceProfileSpecification
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:WorkspaceProfileSpecification
    ] 
].

jacamo:UpdatableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PutMethod, hmas-dev:forTextTurtle, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path hmas:hasInput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:WorkspaceProfileSpecification
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:WorkspaceProfileSpecification
    ] 
].

jacamo:DeletableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:DeleteMethod, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:WorkspaceProfileSpecification
    ] 
].

jacamo:JoinableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forTextTurtle, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:ArtifactProfileSpecification
    ] 
].

jacamo:LeavableWorkspace hmas:signifies [
  	a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forTextTurtle, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:BodyProfileSpecification
    ] 
].

jacamo:FocusableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/focus"
            ]
        ]
    ]
].

jacamo:ArtifactCreatableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forApplicatonJson, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/artifacts/"
            ]
        ]
    ], [
        sh:path hmas:hasInput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:ArtifactCreationDetails
    ], [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:ArtifactProfileSpecification
    ] 
].

jacamo:ArtifactContainableWorkspace hmas:signifies [
    a sh:NodeShape ;
    sh:class hmas:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property hmas-dev:InvokeAction, hmas-dev:PostMethod, hmas-dev:forTextTurtle, hmas-dev:SlugHeader, hmas-dev:XAgentWebIDHeader, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/artifacts/"
            ]
        ]
    ], [
        sh:path hmas:hasInput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:ArtifactProfileSpecification
    ], [
        sh:path hmas:hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape hmas-dev:ArtifactProfileSpecification
    ] 
].

###################################
# Input and Output specifications #
###################################

jacamo:BodyProfileSpecification a sh:NodeShape ;
    sh:class hmas:ResourceProfile ;
    sh:property [
        sh:path hmas:isContainedIn ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype hmas:Workspace
    ], [ 
        sh:path hmas:isProfileOf ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype aa:Body   
    ] .

jacamo:ArtifactCreationDetails a sh:NodeShape ;
    sh:property [
        sh:path aa:hasName ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string
    ], [ 
        sh:path aa:hasClass ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string 
    ], [ 
        sh:path aa:hasInitialisationParameters ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype rdf:List
    ].

########################
# Messaging Signifiers #
########################

jacamo:MessagingCatalog a hmas:SignifiersCatalog ;
    hmas:proposesSignifier jacamo:AgentContactable .


jacamo:AgentContactable a hmas:Signifier ;
    hmas:signifies [
        a sh:NodeShape ;
        sh:class hmas-dev:ActionExecution ;
        sh:property [
            sh:path prov:used ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape [
                sh:class hctl:Form ;
                sh:property  hmas-dev:InvokeAction, hmas-dev:PutMethod, hmas-dev:forApplicatonJson, [
                    sh:path hctl:hasTarget ;
                    sh:minCount 1 ;
                    sh:maxCount 1 ;
                    sh:hasValue "/inbox"
                ]
            ]
        ] , [
            sh:path hmas:hasInput ;
            sh:minQualifiedShape 1 ;
            sh:maxQualifiedShape 1 ;
            sh:qualifiedValueShape jacamo:ACLMessageStructure 
        ]
    ] .

###################################
# Input and Output specifications #
###################################

jacamo:ACLMessageStructure rdf:type sh:NodeShape ;
    sh:targetClass hmas:ACLMessage ;
    sh:property [
        sh:path jason-kqml:hasPerformative ;
        sh:minCount 1 ;
        sh:maxCount 1
    ] , [
        sh:path jason-kqml:hasSender ;
        sh:minCount 1 ;
        sh:maxCount 1
    ] , [
        sh:path jason-kqml:hasReceiver ;
        sh:maxCount 1
    ] , [
        sh:path jason-kqml:hasContent ;
        sh:minCount 1 ;
        sh:maxCount 1
    ] , [
        sh:path jason-kqml:hasLanguage ;
        sh:maxCount 1
    ] .

###################
# JSON-LD Context #
###################

jacamo:context a jsonld:Context ;
    jsonld:version 1.1 ;
    jsonld:definition [
        a jsonld:TermDefinition;
        jsonld:term "artifactName" ;
        jsonld:iri <https://purl.org/hmas/agents-artifacts#hasName>
    ], [
        a jsonld:TermDefinition ;
        jsonld:term "hasClass";
        jsonld:iri <https://purl.org/hmas/agents-artifacts#hasClass> 
    ], [
        a jsonld:TermDefinition ;
        jsonld:term "initParams" ;
        jsonld:iri <https://purl.org/hmas/agents-artifacts#hasInitialisationParameters> ;
        jsonld:container jsonld:listContainerType  
    ] .

# Equivalent JSON-ld context
#{
#  "@context": {
#    "@version" : 1.1,
#    "artifactName" : "https://purl.org/hmas/agents-artifacts#hasName",
#    "artifactClass": "https://purl.org/hmas/agents-artifacts#hasClass",
#    "initParams": {"@id": "https://purl.org/hmas/agents-artifacts#hasInitialisationParameters", "@container": "@list"}}
#}

# Generated JSON 
#{
#  "@id": "https://purl.org/hmas/jacamo#exampleArtifact",
#  "@type": "https://purl.org/hmas/Artifact",
#  "artifactClass": "http://example.org/Counter",
#  "initParams": [ 5 ],
#  "artifactName": "c0"
#}
