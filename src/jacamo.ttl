@prefix : <https://purl.org/hmas/> .
@prefix jacamo: <https://purl.org/hmas/jacamo/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix wotsec: <https://www.w3.org/2019/wot/security#> .
@prefix http: <http://www.w3.org/2011/http#> .


jacamo:WorkspaceCatalog a :SignifiersCatalog ;
    :proposesSignifier jacamo:PerceivableWorkspace ,
                       jacamo:PartitionableWorkspace ,
                       jacamo:UpdatableWorkspace ,
                       jacamo:DeletableWorkspace ,
                       jacamo:JoinableWorkspace ,
                       jacamo:LeavableWorkspace ,
                       jacamo:FocusableWorkspace .

jacamo:PerceivableWorkspace :signifies [
    a sh:NodeShape ;
    sh:class :ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :ReadAction, :GetMethod, :forTextTurtle, [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path :hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:WorkspaceProfile
    ] 
].

jacamo:PartionableWorkspace :signifies [
    a sh:NodeShape ;
    sh:class:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :InvokeAction :PostMethod, :forTextTurtle, :SlugHeader, :XAgentWebIDHeader [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path :hasInput ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:WorkspaceSpecification
    ] , [
        sh:path :hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:WorkspaceSpecification
    ] 
].

jacamo:UpdatableWorkspace :signifies [
    a sh:NodeShape ;
    sh:class:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :InvokeAction :PutMethod, :forTextTurtle, :XAgentWebIDHeader [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path :hasInput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:WorkspaceProfile
    ] , [
        sh:path :hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:WorkspaceProfile
    ] 
].

jacamo:DeletableWorkspace :signifies [
    a sh:NodeShape ;
    sh:class:ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :InvokeAction :DeleteMethod, :XAgentWebIDHeader [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path :hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:WorkspaceProfile
    ] 
].

jacamo:JoinableWorkspace :signifies [
    a sh:NodeShape ;
    sh:class :ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :InvokeAction :PostMethod, :forTextTurtle, :XAgentWebIDHeader [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path :hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:ArtifactProfile
    ] .

jacamo:LeavableWorkspace a sh:NodeShape ;
    sh:class :ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :InvokeAction :PostMethod, :forTextTurtle, :XAgentWebIDHeader [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue ""
            ]
        ]
    ] , [
        sh:path :hasOutput ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape jacamo:BodyProfile
    ] .

jacamo:FocusableWorkspace :signifies [
    a sh:NodeShape ;
    sh:class :ActionExecution ;
    sh:property [
        sh:path prov:used ;
        sh:minQualifiedShape 1 ;
        sh:maxQualifiedShape 1 ;
        sh:qualifiedValueShape [
            sh:class hctl:Form ;
            sh:property :InvokeAction :PostMethod, :XAgentWebIDHeader [
                sh:path hctl:hasTarget ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:hasValue "/focus"
            ]
        ]
    ] 
].

#######################
# Body specifications #
#######################

jacamo:BodyProfile a sh:NodeShape ;
    sh:class :ResourceProfile ;
    sh:property [
        sh:path :isContainedIn ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype :Workspace
    ], [ 
        sh:path :isProfileOf ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype jcm:Body #TODO   
    ] .

jacamo:WorkspaceProfile a sh:NodeShape ;
    sh:class :Workspace ;
    sh:property [
        sh:path td:title ;
        sh:minCount 1 ;
        sh:maxCount 1 ;
        sh:datatype xsd:string 
    ] , [
        sh:path td:hasSecurityConfiguration ;
        sh:datatype wotsec:SecurityScheme
    ] , [
        sh:path td:hasActionAffordance ;
        sh:minQualifiedCount 1 ;
        sh:qualifiedValueShape [
            sh:class td:ActionAffordance ;
            sh:property [
                sh:path td:name ;
                sh:minCount 1 ;
                sh:maxCount 1 ;
                sh:datatype xsd:string
            ] , [
                sh:path td:hasForm ;
                sh:minQualifiedCount 1 ;
                sh:maxQualifiedCount 1 ;
                sh:qualifiedValueShape [
                    sh:class http:Request ;
                    sh:property [
                        sh:path htv:methodName ;
                        sh:minCount 1 ;
                        sh:maxCount 1 ;
                        sh:datatype xsd:string
                    ] , [
                        sh:path hctl:hasTarget ;
                        sh:minCount 1 ;
                        sh:maxCount 1
                    ] , [
                        sh:path hctl:forContentType ;
                        sh:minCount 1 ;
                        sh:maxCount 1 ;
                        sh:datatype xsd:string
                    ] , [
                        sh:path hctl:hasOperationType ;
                        sh:minCount 1 ;
                        sh:maxCount 1 ;
                        sh:datatype td:OperationType
                    ]
                ]
            ] , [
                sh:path td:hasInputSchema ;
                sh:maxCount 1 ;
                sh:datatype js:ObjectSchema
            ]
        ]
    ] , [
        sh:path :isContainedIn ;
        sh:maxCount 1
    ] , [
        sh:path :contains ;
        sh:maxCount 1
    ] .
